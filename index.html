<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Web L√†m Vi·ªác. GV: V√µ Thanh Phong</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* (CSS gi·ªØ nguy√™n ƒë√∫ng nh∆∞ b·∫°n g·ª≠i) */
        :root {
            --primary-color: #4a90e2;
            --secondary-color: #2c3e50;
            --accent-color: #e74c3c;
            --bg-color: #f4f7f6;
            --text-color: #333;
            --white: #ffffff;
            --success-color: #2ecc71;
        }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            font-family: 'Roboto', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
            padding: 20px;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background-color: var(--white);
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }
        header {
            text-align: center;
            margin-bottom: 50px;
            padding: 30px 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(102, 126, 234, 0.3);
            position: relative;
            overflow: hidden;
        }
        header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.1) 0%, transparent 70%);
            animation: shimmer 3s infinite;
            pointer-events: none;
            z-index: 0;
        }
        @keyframes shimmer { 0%{transform:rotate(0);}100%{transform:rotate(360deg);} }
        h1 {
            font-size: 42px;
            background: linear-gradient(135deg, #ffffff 0%, #f0f0f0 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-transform: uppercase;
            margin-bottom: 10px;
            font-weight: 800;
            letter-spacing: 3px;
            text-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
            position: relative;
            z-index: 2;
            line-height: 1.2;
        }
        .gvcn-info {
            font-size: 18px;
            color: rgba(255, 255, 255, 0.95);
            margin-bottom: 20px;
            font-weight: 500;
            letter-spacing: 1px;
            position: relative;
            z-index: 2;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        .gvcn-info i { color: rgba(255,255,255,0.9); font-size:16px; }
        header .contact-section { position: relative; z-index: 2; }
        @media (max-width:600px){
            h1{font-size:28px;letter-spacing:2px;}
            .gvcn-info{font-size:16px;margin-bottom:15px;}
            .gvcn-info i{font-size:14px;}
            .career-section{flex-direction:column;gap:10px;margin:15px 0;}
            .career-section a{font-size:14px;padding:10px 20px;width:100%;justify-content:center;}
            header{padding:20px 15px;margin-bottom:30px;}
        }
        .teacher-info{background:linear-gradient(135deg,#fdfbfb 0%,#ebedee 100%);padding:20px;border-radius:15px;border-left:5px solid var(--primary-color);display:inline-block;box-shadow:0 4px 10px rgba(0,0,0,0.05);}
        .teacher-info p{font-size:18px;font-weight:500;color:var(--secondary-color);margin:5px 0;}
        .teacher-info i{color:var(--primary-color);margin-right:10px;}
        h2{
            font-size:26px;margin:40px 0 25px;padding:15px 20px 15px 25px;border-radius:12px;
            border-left:5px solid #667eea;background:linear-gradient(135deg,rgba(102,126,234,0.08),rgba(118,75,162,0.08));
            text-transform:uppercase;font-weight:700;letter-spacing:1.5px;display:flex;align-items:center;width:100%;
            box-shadow:0 4px 15px rgba(102,126,234,0.1);transition:all .3s ease;color:#667eea;
        }
        h2:hover{transform:translateX(5px);box-shadow:0 6px 20px rgba(102,126,234,0.2);background:linear-gradient(135deg,rgba(102,126,234,0.12),rgba(118,75,162,0.12));}
        h2 i{margin-right:12px;color:#764ba2;font-size:24px;transition:transform .3s;}
        h2:hover i{transform:scale(1.1);}
        .timetable-section{overflow-x:auto;margin-bottom:30px;}
        table{width:100%;border-collapse:collapse;margin-bottom:20px;background:#fff;border-radius:10px;overflow:hidden;box-shadow:0 2px 8px rgba(0,0,0,0.05);}
        th,td{padding:12px;text-align:center;border:1px solid #e0e0e0;font-size:14px;}
        th{background-color:var(--primary-color);color:#fff;font-weight:600;text-transform:uppercase;}
        tr:nth-child(even){background-color:#f9f9f9;}
        tr:hover{background-color:#f1f1f1;}
        td.subject-toan{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;font-weight:600;}
        td.subject-van{background:linear-gradient(135deg,#f093fb,#f5576c);color:#fff;font-weight:600;}
        td.subject-anh{background:linear-gradient(135deg,#4facfe,#00f2fe);color:#fff;font-weight:600;}
        td.subject-dia{background:linear-gradient(135deg,#43e97b,#38f9d7);color:#fff;font-weight:600;}
        td.subject-su{background:linear-gradient(135deg,#fa709a,#fee140);color:#fff;font-weight:600;}
        td.subject-gdktpl{background:linear-gradient(135deg,#30cfd0,#330867);color:#fff;font-weight:600;}
        td.subject-tin{background:linear-gradient(135deg,#a8edea,#fed6e3);color:#333;font-weight:600;}
        td.subject-cn{background:linear-gradient(135deg,#ff9a9e,#fecfef);color:#333;font-weight:600;}
        td.subject-gdtc{background:linear-gradient(135deg,#ffecd2,#fcb69f);color:#333;font-weight:600;}
        td.subject-gdqp{background:linear-gradient(135deg,#ff8a80,#ea6100);color:#fff;font-weight:600;}
        td.subject-gdhn{background:linear-gradient(135deg,#84fab0,#8fd3f4);color:#333;font-weight:600;}
        td.subject-hdtn{background:linear-gradient(135deg,#a1c4fd,#c2e9fb);color:#333;font-weight:600;}
        td.subject-shcn{background:linear-gradient(135deg,#d4fc79,#96e6a1);color:#333;font-weight:600;}
        td[class*="subject-"]:hover{transform:scale(1.05);box-shadow:0 4px 12px rgba(0,0,0,0.2);transition:all .2s ease;}
        .session-title{font-weight:bold;color:var(--accent-color);margin-top:15px;margin-bottom:10px;display:block;}
        td[data-tooltip]{position:relative;cursor:help;}
        td[data-tooltip]:hover::after{
            content:attr(data-tooltip);position:absolute;left:50%;bottom:100%;transform:translateX(-50%);
            margin-bottom:10px;padding:12px 16px;background:var(--secondary-color);color:#fff;border-radius:8px;
            font-size:13px;white-space:pre-line;text-align:left;z-index:1000;box-shadow:0 4px 12px rgba(0,0,0,0.3);
            min-width:220px;max-width:300px;pointer-events:none;animation:fadeIn .3s ease;line-height:1.6;
        }
        td[data-tooltip]:hover::before{
            content:'';position:absolute;left:50%;bottom:100%;transform:translateX(-50%);margin-bottom:2px;
            border:6px solid transparent;border-top-color:var(--secondary-color);z-index:1001;pointer-events:none;
        }
        @keyframes fadeIn{from{opacity:0;transform:translateX(-50%) translateY(-5px);}to{opacity:1;transform:translateX(-50%) translateY(0);}}
        .report-links ul{list-style:none;display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:15px;}
        .report-links a{
            display:flex;align-items:center;text-decoration:none;color:#fff;padding:15px 20px;border-radius:12px;
            font-weight:500;font-size:16px;transition:all .3s ease;box-shadow:0 4px 6px rgba(0,0,0,0.1);
        }
        .report-links a i{margin-right:15px;font-size:20px;width:25px;text-align:center;}
        .report-links a:hover{transform:translateY(-3px);box-shadow:0 8px 15px rgba(0,0,0,0.2);filter:brightness(1.1);}
        .link-1{background:linear-gradient(135deg,#6a11cb,#2575fc);}
        .link-2{background:linear-gradient(135deg,#11998e,#38ef7d);}
        .link-3{background:linear-gradient(135deg,#fc4a1a,#f7b733);}
        .link-4{background:linear-gradient(135deg,#ff9966,#ff5e62);}
        .link-5{background:linear-gradient(135deg,#00c6ff,#0072ff);}
        .link-6{background:linear-gradient(135deg,#834d9b,#d04ed6);}
        .link-7{background:linear-gradient(135deg,#134e5e,#71b280);}
        .link-8{background:linear-gradient(135deg,#cb2d3e,#ef473a);}
        .link-9{background:linear-gradient(135deg,#4b6cb7,#182848);}
        .link-10{background:linear-gradient(135deg,#f093fb,#f5576c);}
        .link-11{background:linear-gradient(135deg,#4facfe,#00f2fe);}
        .link-12{background:linear-gradient(135deg,#fa709a,#fee140);}
        .link-13{background:linear-gradient(135deg,#30cfd0,#330867);}
        .link-14{background:linear-gradient(135deg,#a8edea,#fed6e3);}
        .link-15{background:linear-gradient(135deg,#667eea,#764ba2);}
        .link-16{background:linear-gradient(135deg,#f093fb,#f5576c);}
        .link-17{background:linear-gradient(135deg,#00c6ff,#0072ff);}
        .career-section{position:relative;z-index:2;margin:20px 0;display:flex;gap:15px;justify-content:center;flex-wrap:wrap;}
        .career-section a{
            display:inline-flex;align-items:center;text-decoration:none;color:#fff;padding:12px 24px;border-radius:25px;
            font-weight:600;font-size:15px;transition:all .3s;box-shadow:0 4px 15px rgba(0,0,0,0.2);
        }
        .career-section a:hover{transform:translateY(-3px);box-shadow:0 6px 20px rgba(0,0,0,0.3);filter:brightness(1.1);}
        .career-section a i{margin-right:10px;font-size:18px;}
        .birthday-section{
            background:linear-gradient(135deg,#ff6b6b,#feca57,#48dbfb);border-radius:20px;padding:30px;margin:30px 0;text-align:center;
            box-shadow:0 10px 40px rgba(255,107,107,0.3);position:relative;overflow:hidden;animation:birthdayPulse 2s ease-in-out infinite;
        }
        @keyframes birthdayPulse{0%,100%{transform:scale(1);}50%{transform:scale(1.02);}}
        .birthday-section.hidden{display:none;}
        .birthday-content{position:relative;z-index:2;}
        .birthday-icon{font-size:60px;color:#fff;margin-bottom:15px;animation:bounce 1s ease-in-out infinite;}
        @keyframes bounce{0%,100%{transform:translateY(0);}50%{transform:translateY(-10px);}}
        .birthday-message{font-size:24px;color:#fff;font-weight:700;text-shadow:2px 2px 4px rgba(0,0,0,0.3);margin:10px 0;line-height:1.6;}
        .birthday-name{color:#fff;font-size:28px;font-weight:800;text-shadow:2px 2px 6px rgba(0,0,0,0.4);display:inline-block;animation:nameGlow 2s ease-in-out infinite;}
        @keyframes nameGlow{0%,100%{text-shadow:2px 2px 6px rgba(0,0,0,0.4),0 0 20px rgba(255,255,255,0.5);}50%{text-shadow:2px 2px 6px rgba(0,0,0,0.4),0 0 30px rgba(255,255,255,0.8);}}
        .confetti{position:fixed;width:10px;height:10px;background:#ff6b6b;top:-10px;animation:confettiFall linear forwards;z-index:1000;pointer-events:none;}
        @keyframes confettiFall{to{transform:translateY(100vh) rotate(360deg);opacity:0;}}
        .password-modal{display:none;position:fixed;z-index:1000;left:0;top:0;width:100%;height:100%;background:rgba(0,0,0,0.5);justify-content:center;align-items:center;}
        .password-modal.active{display:flex;}
        .password-content{background:#fff;padding:30px;border-radius:15px;box-shadow:0 10px 30px rgba(0,0,0,0.3);max-width:400px;width:90%;text-align:center;}
        .password-content h3{color:var(--secondary-color);margin-bottom:20px;font-size:20px;}
        .password-content input{width:100%;padding:12px;border:2px solid #e0e0e0;border-radius:8px;font-size:16px;margin-bottom:15px;box-sizing:border-box;}
        .password-content input:focus{outline:none;border-color:var(--primary-color);}
        .password-content button{background:linear-gradient(135deg,#4a90e2,#357abd);color:#fff;border:none;padding:12px 30px;border-radius:8px;font-size:16px;font-weight:500;cursor:pointer;transition:all .3s;margin-right:10px;}
        .password-content button:hover{transform:translateY(-2px);box-shadow:0 4px 10px rgba(0,0,0,0.2);}
        .password-content .btn-cancel{background:linear-gradient(135deg,#95a5a6,#7f8c8d);}
        .password-error{color:var(--accent-color);font-size:14px;margin-top:10px;display:none;}
        .contact-section{display:flex;justify-content:center;gap:20px;margin-top:40px;padding-top:20px;border-top:1px solid #eee;}
        .btn-contact{display:inline-flex;align-items:center;justify-content:center;padding:12px 30px;border-radius:50px;text-decoration:none;font-weight:bold;color:#fff;transition:transform .2s;box-shadow:0 4px 10px rgba(0,0,0,0.2);}
        .btn-contact:hover{transform:scale(1.05);}
        .btn-call{background:var(--success-color);}
        .btn-zalo{background:#0068ff;}
        .btn-contact i{margin-right:10px;}
        .memories-section{margin:30px 0;}
        .memory-card{
            background:linear-gradient(135deg,#7f7fd5,#86a8e7,#91eae4);border-radius:16px;padding:18px 20px;
            box-shadow:0 12px 30px rgba(0,0,0,0.2);color:#fff;display:flex;align-items:center;justify-content:space-between;gap:12px;flex-wrap:wrap;
        }
        .memory-title{font-weight:800;font-size:20px;display:flex;align-items:center;gap:10px;margin:0;}
        .memory-title i{font-size:22px;}
        .memory-btn{
            padding:12px 18px;border-radius:10px;border:1px solid rgba(255,255,255,0.6);background:rgba(255,255,255,0.2);
            color:#fff;font-weight:700;text-decoration:none;box-shadow:0 6px 16px rgba(0,0,0,0.15);transition:all .2s;
        }
        .memory-btn:hover{transform:translateY(-2px);box-shadow:0 8px 18px rgba(0,0,0,0.2);}
        .admission-section{
            margin:30px 0;padding:20px;border-radius:16px;background:linear-gradient(135deg,#1f1c2c,#928dab);
            color:#fff;box-shadow:0 10px 28px rgba(0,0,0,0.22);
        }
        .admission-title{display:flex;align-items:center;gap:10px;font-size:20px;font-weight:800;margin-bottom:14px;}
        .admission-title i{font-size:22px;}
        .admission-form{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:12px;margin-bottom:14px;}
        .combo-dropdown{width:100%;padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,0.35);background:rgba(0,0,0,0.25);color:#fff;font-weight:700;}
        .combo-dropdown option{background:#1f1c2c;color:#fff;}
        .admission-suggestion{margin-top:10px;font-size:13px;color:#fefefe;background:rgba(255,255,255,0.08);padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,0.15);}
        .admission-form label{display:block;font-weight:600;margin-bottom:6px;}
        .admission-form input{width:100%;padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,0.35);background:rgba(255,255,255,0.08);color:#fff;font-weight:600;}
        .admission-form input::placeholder{color:rgba(255,255,255,0.7);}
        .admission-actions{display:flex;gap:10px;flex-wrap:wrap;margin-bottom:12px;}
        .admission-btn{
            border:none;border-radius:10px;padding:10px 16px;font-weight:700;color:#1f1c2c;
            background:linear-gradient(135deg,#ffefba,#ffffff);cursor:pointer;box-shadow:0 6px 16px rgba(0,0,0,0.2);transition:transform .15s;
        }
        .admission-btn:hover{transform:translateY(-2px);}
        .admission-result{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:10px;margin-top:10px;}
        .admission-card{
            background:rgba(255,255,255,0.08);border:1px solid rgba(255,255,255,0.2);border-radius:12px;padding:12px;
            box-shadow:inset 0 0 0 1px rgba(255,255,255,0.05);
        }
        .admission-card h4{margin:0 0 6px;font-size:15px;font-weight:800;}
        .admission-card p{margin:0;font-size:14px;color:#e0e3ff;}
        .admission-note{margin-top:10px;font-size:13px;color:#e0e3ff;}
        .countdown-section{
            margin:32px 0;padding:10px;border-radius:16px;
            background:linear-gradient(135deg,#1e2a78,#4a90e2,#9c27b0);color:#fff;
            box-shadow:0 10px 30px rgba(0,0,0,0.25);position:relative;overflow:hidden;
        }
        .countdown-section::before,.countdown-section::after{
            content:'';position:absolute;width:220px;height:220px;border-radius:50%;
            background:radial-gradient(circle,rgba(255,255,255,0.35),rgba(255,255,255,0));filter:blur(6px);animation:glowMove 10s linear infinite;
        }
        .countdown-section::before{top:-80px;left:-60px;}
        .countdown-section::after{bottom:-100px;right:-80px;animation-direction:reverse;}
        @keyframes glowMove{0%{transform:translate(0,0) scale(1);}50%{transform:translate(30px,20px) scale(1.1);}100%{transform:translate(0,0) scale(1);}}
        .countdown-title{display:flex;align-items:center;gap:10px;font-size:22px;font-weight:700;margin-bottom:18px;position:relative;z-index:1;}
        .countdown-title i{font-size:24px;}
        .countdown{display:grid;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:12px;position:relative;z-index:1;}
        .countdown-card{
            background:rgba(255,255,255,0.08);border:1px solid rgba(255,255,255,0.2);border-radius:12px;padding:16px;text-align:center;
            box-shadow:inset 0 0 0 1px rgba(255,255,255,0.08),0 6px 18px rgba(0,0,0,0.2);backdrop-filter:blur(6px);
        }
        .countdown-value{font-size:32px;font-weight:800;letter-spacing:1px;margin-bottom:6px;color:#ffeb3b;text-shadow:0 0 12px rgba(255,235,59,0.8);}
        .countdown-label{font-size:14px;letter-spacing:.5px;color:#e3e7ff;}
        .countdown-note{margin-top:12px;text-align:center;font-size:14px;color:#e0e3ff;position:relative;z-index:1;}
        .countdown-section--compact{
            margin:10px 0;
            padding:6px 8px;
            border-radius:10px;
        }
        .countdown-section--compact .countdown{
            gap:6px;
        }
        .countdown-section--compact .countdown-title{
            font-size:14px;
            margin-bottom:4px;
        }
        .countdown-section--compact .countdown-card{
            padding:6px;
        }
        .countdown-section--compact .countdown-value{
            font-size:18px;
        }
        .countdown-section--compact .countdown-label{
            font-size:10px;
        }
        .countdown-section--main{
            background:linear-gradient(135deg,#1e2a78,#4a90e2,#00c6ff);
        }
        .countdown-section--hsg{
            background:linear-gradient(135deg,#4a148c,#d500f9,#ff4081);
        }

        /* Wheel visual */
        .wheel-visual {
            display: flex;
            justify-content: center;
            margin: 18px 0 20px;
            position: relative;
        }
        .wheel-circle {
            width: 220px;
            height: 220px;
            border-radius: 50%;
            background:
              radial-gradient(circle at 30% 30%, #ffffff, #ffe9f2 40%, #ffd3b6 60%, #ff9a9e 80%);
            box-shadow:
              0 10px 25px rgba(0,0,0,0.25),
              inset 0 0 0 6px rgba(255,255,255,0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            border: 4px solid rgba(255,255,255,0.9);
            position: relative;
            overflow: hidden;
        }
        .wheel-circle::before {
            content: '';
            position: absolute;
            inset: 12px;
            border-radius: 50%;
            background: radial-gradient(circle at 20% 20%, rgba(255,255,255,0.9), transparent 55%);
            opacity: 0.85;
        }
        .wheel-pointer {
            position: absolute;
            top: -2px;
            width: 0;
            height: 0;
            border-left: 16px solid transparent;
            border-right: 16px solid transparent;
            border-bottom: 26px solid var(--accent-color);
            filter: drop-shadow(0 4px 6px rgba(0,0,0,0.35));
        }
        #random-result {
            position: relative;
            z-index: 2;
            font-size: 24px;
            font-weight: 800;
            color: #b31237;
            text-shadow: 0 2px 4px rgba(255,255,255,0.6);
            padding: 0 14px;
        }
        .wheel-circle.spinning {
            animation: wheel-spin 0.9s linear infinite;
        }
        @keyframes wheel-spin {
            from { transform: rotate(0deg); }
            to   { transform: rotate(360deg); }
        }
        @media (max-width:600px){
            .countdown-title{font-size:18px;}
            .countdown{grid-template-columns:repeat(2,minmax(120px,1fr));}
            .countdown-value{font-size:28px;}
        }
        .ranking-embed{width:100%;max-width:1100px;margin:0 auto;border-radius:12px;box-shadow:0 6px 20px rgba(0,0,0,0.15);background:#fff;overflow:hidden;padding:10px;}
        .ranking-table-wrap{overflow-x:auto;overflow-y:auto;-webkit-overflow-scrolling:touch;touch-action:pan-x;overscroll-behavior:contain;max-height:320px;}
        .ranking-table{width:100%;border-collapse:collapse;min-width:640px;table-layout:fixed;}
        .ranking-table th,.ranking-table td{border:1px solid #e0e0e0;padding:8px 10px;text-align:center;font-size:14px;vertical-align:middle;}
        .ranking-table th{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;position:sticky;top:0;z-index:1;font-weight:700;}
        .ranking-status{text-align:center;color:#555;font-size:14px;margin-bottom:8px;}
        .ranking-table td.col-week{background:linear-gradient(135deg,#fff8e1,#ffecb3);font-weight:700;}
        .ranking-table td.col-t1{background:linear-gradient(135deg,#e8f5e9,#c8e6c9);}
        .ranking-table td.col-t2{background:linear-gradient(135deg,#e3f2fd,#bbdefb);}
        .ranking-table td.col-t3{background:linear-gradient(135deg,#fce4ec,#f8bbd0);}
        .ranking-table td.col-t4{background:linear-gradient(135deg,#ede7f6,#d1c4e9);}
        .ranking-table td.col-rank{background:linear-gradient(135deg,#f3e5f5,#e1bee7);font-weight:700;color:#5c3c87;}
        .winner-cell{
            position:relative;z-index:2;background:linear-gradient(135deg,#ffb6f6,#ff9df0 30%,#ffd36f 70%,#fff1b8 100%)!important;
            color:#2b1d00!important;font-weight:800;border:2px solid #ffd700;box-shadow:0 0 0 2px rgba(255,255,255,0.7),0 0 26px rgba(255,180,255,0.9),0 10px 24px rgba(0,0,0,0.32);
            animation:winnerPulse 1.4s ease-in-out infinite;border-radius:12px;overflow:hidden;
        }
        .winner-cell::before{
            content:'';position:absolute;inset:-6px;border-radius:14px;
            background:linear-gradient(135deg,#ff80ff 0%,#ffd36f 40%,#8be2ff 80%,#ff80ff 100%);
            z-index:-1;animation:winnerFrame 2s linear infinite;
        }
        .winner-cell::after{
            content:'';position:absolute;inset:2px;border-radius:10px;
            background:radial-gradient(circle at 10% 10%,rgba(255,255,255,0.45),rgba(255,255,255,0) 35%),
                radial-gradient(circle at 90% 15%,rgba(255,255,255,0.35),rgba(255,255,255,0) 40%),
                radial-gradient(circle at 50% 95%,rgba(255,214,255,0.4),rgba(255,214,255,0) 45%);
            pointer-events:none;z-index:-1;
        }
        @keyframes winnerPulse{0%,100%{box-shadow:0 0 0 0 rgba(255,215,0,0.7),0 0 22px rgba(255,200,64,0.95),0 8px 22px rgba(0,0,0,0.32);}50%{box-shadow:0 0 0 18px rgba(255,215,0,0),0 0 30px rgba(255,200,64,0.98),0 10px 26px rgba(0,0,0,0.34);}}
        @keyframes winnerFrame{0%{filter:hue-rotate(0);}100%{filter:hue-rotate(360deg);}}
        @media (max-width:600px){
            .ranking-table{min-width:560px;}
            .ranking-table th,.ranking-table td{padding:6px 8px;font-size:13px;}
            .ranking-table-wrap{max-height:360px;}
        }
        @media (max-width:600px){
            .container{padding:15px;}
            h1{font-size:22px;}
            .gvcn-info{font-size:14px;}
            .teacher-info p{font-size:16px;}
            .timetable-section{margin-bottom:20px;}
            table{font-size:11px;min-width:100%;}
            th,td{padding:6px 4px;font-size:10px;word-break:break-word;}
            th{font-size:9px;padding:6px 2px;}
            .session-title{font-size:13px;margin-top:10px;margin-bottom:8px;}
            h2{font-size:20px;margin:30px 0 20px;padding:12px 15px;letter-spacing:1px;}
            h2 i{font-size:20px;margin-right:10px;}
            .contact-section{flex-direction:column;}
            .report-links ul{grid-template-columns:1fr;}
            td[data-tooltip]:hover::after{min-width:150px;max-width:200px;font-size:11px;padding:8px 10px;}
        }
        @media (max-width:400px){
            table{font-size:10px;}
            th,td{padding:5px 2px;font-size:9px;}
            th{font-size:8px;padding:5px 1px;}
            .session-title{font-size:12px;}
        }
    </style>
</head>

<body>
    <div class="container">
        <header>
            <h1 data-text="class.fullName">Web L√†m Vi·ªác</h1>
            <div class="gvcn-info">
                <i class="fas fa-chalkboard-teacher"></i>
                <span data-text="gvcn.display">GV: V√µ Thanh Phong</span>
            </div>
            <div class="career-section">
                <a href="#" data-link="career.chatgpt"
                    class="link-15" target="_blank"><i class="fas fa-robot"></i> Bot T∆∞ v·∫•n h∆∞·ªõng nghi·ªáp</a>
                <a href="#" data-link="career.registerForm" class="link-16" target="_blank"><i
                        class="fas fa-user-graduate"></i> ƒêƒÉng k√Ω t∆∞ v·∫•n h·ªçc ƒë∆∞·ªùng</a>
            </div>
            <div style="text-align:center; margin-top: 8px;">
                <button id="week-button" class="admission-btn" type="button" style="min-width: 260px;">
                    Tu·∫ßn hi·ªán t·∫°i: ƒëang t√≠nh...
                </button>
            </div>
            <section class="contact-section">
                <a href="#" data-link="gvcn.phone" class="btn-contact btn-call"><i class="fas fa-phone-volume"></i> G·ªçi ƒêi·ªán</a>
                <a href="#" data-link="gvcn.zalo" class="btn-contact btn-zalo" target="_blank"><i
                        class="fas fa-comment-dots"></i> Li√™n h·ªá Zalo</a>
            </section>
        </header>

        <!-- Birthday Section -->
        <section class="birthday-section hidden" id="birthdaySection">
            <div class="birthday-content">
                <div class="birthday-icon">
                    <i class="fas fa-birthday-cake"></i>
                </div>
                <div class="birthday-message" id="birthdayMessage">
                    Ch√∫c m·ª´ng b·∫°n <span class="birthday-name" id="birthdayName"></span>!<br>
                    Sinh nh·∫≠t vui v·∫ª v√† ng√†y c√†ng h·ªçc gi·ªèi! üéâ
                </div>
            </div>
        </section>

        <!-- Countdown c√°c m·ªëc l·ªõn trong nƒÉm -->
        <section class="countdown-section countdown-section--compact countdown-section--main" id="phase-countdown">
            <div class="countdown-title"><i class="fas fa-hourglass-half"></i> ƒê·∫øm ng∆∞·ª£c m·ªëc quan tr·ªçng</div>
            <div class="countdown" id="countdown">
                <div class="countdown-card">
                    <div class="countdown-value" id="cd-days">--</div>
                    <div class="countdown-label">Ng√†y</div>
                </div>
                <div class="countdown-card">
                    <div class="countdown-value" id="cd-hours">--</div>
                    <div class="countdown-label">Gi·ªù</div>
                </div>
                <div class="countdown-card">
                    <div class="countdown-value" id="cd-mins">--</div>
                    <div class="countdown-label">Ph√∫t</div>
                </div>
                <div class="countdown-card">
                    <div class="countdown-value" id="cd-secs">--</div>
                    <div class="countdown-label">Gi√¢y</div>
                </div>
            </div>
            <p class="countdown-note">ƒêang t√≠nh m·ªëc ti·∫øp theo...</p>
        </section>

        <!-- Countdown thi H·ªçc sinh gi·ªèi -->
        <section class="countdown-section countdown-section--compact countdown-section--hsg" style="margin-top: 12px;" id="hsg-countdown">
            <div class="countdown-title"><i class="fas fa-star"></i> ƒê·∫øm ng∆∞·ª£c thi H·ªçc sinh gi·ªèi 12/03/2026</div>
            <div class="countdown" id="countdown-hsg">
                <div class="countdown-card">
                    <div class="countdown-value" id="cd2-days">--</div>
                    <div class="countdown-label">Ng√†y</div>
                </div>
                <div class="countdown-card">
                    <div class="countdown-value" id="cd2-hours">--</div>
                    <div class="countdown-label">Gi·ªù</div>
                </div>
                <div class="countdown-card">
                    <div class="countdown-value" id="cd2-mins">--</div>
                    <div class="countdown-label">Ph√∫t</div>
                </div>
                <div class="countdown-card">
                    <div class="countdown-value" id="cd2-secs">--</div>
                    <div class="countdown-label">Gi√¢y</div>
                </div>
            </div>
        </section>

        <section class="report-links">
            <h2><i class="fas fa-gamepad"></i> TR·ª¢ TH·ª¶ TRI B√ÄI</h2>
            <div
                style="text-align:center; background: white; padding: 20px; border-radius: 16px; box-shadow: 0 10px 30px rgba(0,0,0,0.1);">
                <div style="margin-bottom: 12px;">
                    <label for="wheel-class-select" style="font-weight:600;margin-right:8px;">Ch·ªçn l·ªõp:</label>
                    <select id="wheel-class-select" class="combo-dropdown" style="max-width: 220px; display:inline-block; color:#333; background:#fff; border-color:#ddd;">
                        <option value="12C1">12C1</option>
                        <option value="11B1">11B1</option>
                    </select>
                </div>
                <div id="wheel-status" class="subtext" style="margin-bottom: 6px; font-size: 13px;">
                    ƒêang t·∫£i danh s√°ch 12C1 t·ª´ Google Sheets...
                </div>
                <div class="wheel-visual">
                    <div class="wheel-pointer"></div>
                    <div class="wheel-circle" id="wheel-circle">
                        <div id="random-result">???</div>
                    </div>
                </div>
                <button onclick="spinRandom()" class="admission-btn"
                    style="background: var(--primary-color); color: white;">
                    <i class="fas fa-sync-alt"></i> Quay ng·∫´u nhi√™n
                </button>
            </div>
        </section>

        <section class="timetable-section">
            <h2><i class="fas fa-calendar-alt"></i> Th·ªùi Kh√≥a Bi·ªÉu</h2>
            <div id="timetable-status" style="text-align:center; margin: 10px 0; font-size: 14px; color: #555;">ƒêang t·∫£i th·ªùi kh√≥a bi·ªÉu...</div>

            <span class="session-title">Bu·ªïi S√°ng (√Åp d·ª•ng: 01-12-2025)</span>
            <table id="timetable-morning">
                <thead>
                    <tr>
                        <th>Ti·∫øt</th>
                        <th>Hai</th>
                        <th>Ba</th>
                        <th>T∆∞</th>
                        <th>NƒÉm</th>
                        <th>S√°u</th>
                        <th>B·∫£y</th>
                    </tr>
                </thead>
                <tbody id="timetable-morning-body">
                    <!-- D·ªØ li·ªáu s·∫Ω ƒë∆∞·ª£c load t·ª´ Google Sheets -->
                </tbody>
            </table>

            <span class="session-title">Tr√°i Bu·ªïi: Chi·ªÅu</span>
            <table id="timetable-afternoon">
                <thead>
                    <tr>
                        <th>Ti·∫øt</th>
                        <th>Hai</th>
                        <th>Ba</th>
                        <th>T∆∞</th>
                        <th>NƒÉm</th>
                        <th>S√°u</th>
                        <th>B·∫£y</th>
                    </tr>
                </thead>
                <tbody id="timetable-afternoon-body">
                    <!-- D·ªØ li·ªáu s·∫Ω ƒë∆∞·ª£c load t·ª´ Google Sheets -->
                </tbody>
            </table>
        </section>

        <section class="report-links">
            <h2><i class="fas fa-trophy"></i> B·∫£ng x·∫øp h·∫°ng T·ªï</h2>
            <div class="ranking-embed">
                <div id="rankingStatus" class="ranking-status">ƒêang t·∫£i b·∫£ng...</div>
                <div class="ranking-table-wrap">
                    <table class="ranking-table" id="rankingTable"></table>
                </div>
            </div>
        </section>

        <section class="report-links">
            <h2><i class="fas fa-laptop-code"></i> H·ªçc online v√† Roboki AI cho h·ªçc sinh</h2>
            <ul>
                <li><a href="#" data-link="learning.khanAcademy" class="link-12" target="_blank"><i
                            class="fas fa-graduation-cap"></i> KAV</a></li>
                <li><a href="#" data-link="learning.roboki" class="link-13" target="_blank"><i
                            class="fas fa-robot"></i> Gia s∆∞ ROBOKI AI</a></li>
                <li><a href="#" data-link="learning.smsEdu" class="link-14" target="_blank"><i
                            class="fas fa-chart-bar"></i> K·∫øt qu·∫£ h·ªçc t·∫≠p Smas</a></li>
                <li><a href="#" data-link="learning.toanmath" class="link-17" target="_blank"><i class="fas fa-book"></i> Kho t√†i
                        li·ªáu & ƒê·ªÅ thi To√°n</a></li>
            </ul>
        </section>

        <section class="admission-section">
            <div class="admission-title"><i class="fas fa-calculator"></i> T√≠nh ƒëi·ªÉm x√©t tuy·ªÉn ƒê·∫°i h·ªçc</div>
            <div class="admission-form">
                <!-- (gi·ªØ nguy√™n to√†n b·ªô form v√† select nh∆∞ b·∫°n ƒë√£ g·ª≠i, ƒë√£ c√≥ trong b·∫£n tr∆∞·ªõc) -->
            </div>
            <!-- ph·∫ßn k·∫øt qu·∫£, note... gi·ªØ nguy√™n trong script -->
        </section>

        <section class="memories-section">
            <div class="memory-card">
                <div class="memory-title"><i class="fas fa-images"></i> K·ª∑ ni·ªám l·ªõp <span data-text="class.className">12C1</span></div>
                <a class="memory-btn" href="#" data-link="photos.album" target="_blank" rel="noopener">Xem album</a>
            </div>
        </section>

        <!-- C√°c section b√°o c√°o, GVCN... b·∫°n c√≥ th·ªÉ d√°n ti·∫øp v√†o ƒë√¢y t·ª´ m·∫´u g·ªëc -->
    </div>

    <div id="passwordModal" class="password-modal">
        <div class="password-content">
            <h3><i class="fas fa-lock"></i> Nh·∫≠p m·∫≠t kh·∫©u</h3>
            <input type="password" id="passwordInput" placeholder="Nh·∫≠p m·∫≠t kh·∫©u..." autofocus>
            <div class="password-error" id="passwordError">M·∫≠t kh·∫©u kh√¥ng ƒë√∫ng!</div>
            <div>
                <button onclick="validateInput()">X√°c nh·∫≠n</button>
                <button class="btn-cancel" onclick="closePasswordModal()">H·ªßy</button>
            </div>
        </div>
    </div>

    <script src="config.js"></script>
    <script>
      // ====== V√≤ng quay may m·∫Øn theo Google Sheets (m·ªói l·ªõp m·ªôt URL CSV ri√™ng) ======
      const WHEEL_SHEETS = typeof WHEEL_SHEETS_CONFIG !== "undefined" ? WHEEL_SHEETS_CONFIG : {};

      const wheelClassSelect = document.getElementById("wheel-class-select");
      const wheelStatus = document.getElementById("wheel-status");
      const randomResultEl = document.getElementById("random-result");
      const wheelCircle = document.getElementById("wheel-circle");

      let currentClassId = "12C1";
      let currentStudents = [];

      function setWheelStatus(text) {
        if (wheelStatus) wheelStatus.textContent = text;
      }

      function parseCsv(text) {
        const rows = [];
        let row = [];
        let current = "";
        let inQuotes = false;

        for (let i = 0; i < text.length; i++) {
          const c = text[i];
          const next = text[i + 1];
          if (c === '"' && inQuotes && next === '"') {
            current += '"';
            i++;
          } else if (c === '"') {
            inQuotes = !inQuotes;
          } else if (c === "," && !inQuotes) {
            row.push(current);
            current = "";
          } else if ((c === "\n" || c === "\r") && !inQuotes) {
            if (current !== "" || row.length) {
              row.push(current);
              rows.push(row);
              row = [];
              current = "";
            }
          } else {
            current += c;
          }
        }
        if (current !== "" || row.length) {
          row.push(current);
          rows.push(row);
        }
        return rows;
      }

      async function loadStudentsForClass(classId) {
        try {
          const url = WHEEL_SHEETS[classId];
          if (!url) {
            currentStudents = [];
            setWheelStatus(`Ch∆∞a c·∫•u h√¨nh URL cho l·ªõp ${classId}.`);
            return;
          }

          setWheelStatus(`ƒêang t·∫£i danh s√°ch ${classId} t·ª´ Google Sheets...`);
          const resp = await fetch(url, { cache: "no-store" });
          if (!resp.ok) {
            throw new Error("HTTP " + resp.status);
          }
          const text = await resp.text();
          const rows = parseCsv(text);
          if (!rows.length) {
            throw new Error("Kh√¥ng c√≥ d·ªØ li·ªáu");
          }

          // CSV: c·ªôt 0 = s·ªë th·ª© t·ª±, c·ªôt 1 = H·ªç t√™n
          const names = rows
            .map((r) => (r[1] || "").trim())
            .filter((name) => name && !/t√™n|h·ªç t√™n|danh\s*s√°ch/i.test(name));

          currentStudents = names;
          if (!currentStudents.length) {
            setWheelStatus(`Kh√¥ng t√¨m th·∫•y t√™n h·ªçc sinh cho l·ªõp ${classId}.`);
          } else {
            setWheelStatus(`ƒê√£ t·∫£i ${currentStudents.length} h·ªçc sinh l·ªõp ${classId}.`);
          }
        } catch (e) {
          console.error(e);
          currentStudents = [];
          setWheelStatus(
            `Kh√¥ng t·∫£i ƒë∆∞·ª£c danh s√°ch l·ªõp ${classId}. Ki·ªÉm tra l·∫°i link CSV ho·∫∑c k·∫øt n·ªëi m·∫°ng.`
          );
        }
      }

      function spinRandom() {
        if (!currentStudents.length) {
          randomResultEl.textContent = "Ch∆∞a c√≥ danh s√°ch t√™n c·ªßa l·ªõp n√†y.";
          randomResultEl.style.color = "#e74c3c";
          return;
        }

        if (wheelCircle) {
          wheelCircle.classList.add("spinning");
        }

        const names = currentStudents.slice();
        const resultEl = randomResultEl;
        const start = performance.now();
        const duration = 6000;
        const startSpeed = 40;
        const endSpeed = 260;

        function easeOutCubic(x) {
          return 1 - Math.pow(1 - x, 3);
        }

        function tick() {
          const now = performance.now();
          const progress = Math.min((now - start) / duration, 1);
          const ease = easeOutCubic(progress);
          const speed = startSpeed + (endSpeed - startSpeed) * ease;

          const randomIndex = Math.floor(Math.random() * names.length);
          resultEl.textContent = names[randomIndex];
          resultEl.style.color = "#333";

          if (progress >= 1) {
            resultEl.style.color = "#e74c3c";
            resultEl.style.transform = "scale(1.2)";
            setTimeout(() => (resultEl.style.transform = "scale(1)"), 220);
            if (wheelCircle) {
              setTimeout(() => wheelCircle.classList.remove("spinning"), 220);
            }
            return;
          }

          setTimeout(tick, speed);
        }

        tick();
      }

      window.spinRandom = spinRandom;

      document.addEventListener("DOMContentLoaded", () => {
        if (wheelClassSelect) {
          wheelClassSelect.addEventListener("change", async (e) => {
            currentClassId = e.target.value;
            await loadStudentsForClass(currentClassId);
          });
        }
        loadStudentsForClass(currentClassId);
      });

      // ====== Load v√† render Th·ªùi Kh√≥a Bi·ªÉu t·ª´ Google Sheets ======
      const TIMETABLE_URL = typeof TIMETABLE_SHEET_URL !== "undefined" ? TIMETABLE_SHEET_URL : null;

      // Map t√™n m√¥n h·ªçc sang class CSS
      function getSubjectClass(subjectName) {
        if (!subjectName) return "";
        const name = subjectName.toLowerCase().trim();
        const map = {
          "to√°n": "subject-toan",
          "vƒÉn": "subject-van",
          "anh": "subject-anh",
          "ƒë·ªãa": "subject-dia",
          "s·ª≠": "subject-su",
          "gdkt&pl": "subject-gdktpl",
          "gdktpl": "subject-gdktpl",
          "tin": "subject-tin",
          "cn": "subject-cn",
          "c√¥ng ngh·ªá": "subject-cn",
          "gdtc": "subject-gdtc",
          "gdqp": "subject-gdqp",
          "gdhn": "subject-gdhn",
          "hdtn": "subject-hdtn",
          "hƒëtn": "subject-hdtn",
          "shcn": "subject-shcn"
        };
        for (const [key, cls] of Object.entries(map)) {
          if (name.includes(key)) return cls;
        }
        return "";
      }

      // Map t√™n th·ª© sang index c·ªôt (Hai=1, Ba=2, T∆∞=3, NƒÉm=4, S√°u=5, B·∫£y=6)
      function getDayIndex(dayName) {
        const day = dayName.toLowerCase().trim();
        const map = {
          "hai": 1, "th·ª© hai": 1, "2": 1,
          "ba": 2, "th·ª© ba": 2, "3": 2,
          "t∆∞": 3, "th·ª© t∆∞": 3, "4": 3,
          "nƒÉm": 4, "th·ª© nƒÉm": 4, "5": 4,
          "s√°u": 5, "th·ª© s√°u": 5, "6": 5,
          "b·∫£y": 6, "th·ª© b·∫£y": 6, "7": 6
        };
        for (const [key, idx] of Object.entries(map)) {
          if (day.includes(key)) return idx;
        }
        return -1;
      }

      function renderTimetableTable(tableId, data, isMorning) {
        const table = document.getElementById(tableId);
        if (!table) {
          console.error(`Table ${tableId} not found`);
          return;
        }

        const tbodyId = tableId === "timetable-morning" ? "timetable-morning-body" : "timetable-afternoon-body";
        let tbody = document.getElementById(tbodyId);
        if (!tbody) {
          tbody = table.querySelector("tbody");
        }
        if (!tbody) {
          console.error(`Tbody not found for ${tableId}`);
          return;
        }

        // X√ìA S·∫†CH D·ªÆ LI·ªÜU C≈®
        tbody.innerHTML = "";

        // T·∫°o c·∫•u tr√∫c b·∫£ng: 5 h√†ng (ti·∫øt 1-5) x 6 c·ªôt (6 th·ª©)
        const rows = Array(5).fill(null).map(() => Array(6).fill(null));
        
        // ƒêi·ªÅn d·ªØ li·ªáu v√†o m·∫£ng
        let countAdded = 0;
        for (const item of data) {
          const dayIdx = getDayIndex(item.thu || item.th·ª© || "");
          const periodStr = String(item.tiet || item.ti·∫øt || item.period || "0").trim();
          const period = parseInt(periodStr);
          const subject = (item.mon || item.m√¥n || item.subject || "").trim();
          const teacher = (item.gv || item.gi√°o_vi√™n || item.teacher || "").trim();
          const buoi = (item.buoi || item.bu·ªïi || "").toLowerCase().trim();

          // L·ªçc theo bu·ªïi (n·∫øu c√≥ th√¥ng tin bu·ªïi)
          if (buoi) {
            if (isMorning && !buoi.includes("s√°ng") && !buoi.includes("morning") && buoi !== "s") continue;
            if (!isMorning && !buoi.includes("chi·ªÅu") && !buoi.includes("afternoon") && buoi !== "c") continue;
          }

          if (dayIdx >= 1 && dayIdx <= 6 && period >= 1 && period <= 5 && subject) {
            // dayIdx t·ª´ 1-6, nh∆∞ng array index t·ª´ 0-5
            const colIdx = dayIdx - 1;
            const rowIdx = period - 1;
            
            if (!rows[rowIdx][colIdx]) {
              rows[rowIdx][colIdx] = { subject, teacher, class: getSubjectClass(subject), period };
              countAdded++;
            }
          }
        }

        console.log(`Rendered ${isMorning ? 'morning' : 'afternoon'} table: ${countAdded} items added`, rows);

        // Render v√†o tbody
        for (let period = 1; period <= 5; period++) {
          const tr = document.createElement("tr");
          const periodTd = document.createElement("td");
          periodTd.textContent = period;
          tr.appendChild(periodTd);
          
          for (let dayIdx = 1; dayIdx <= 6; dayIdx++) {
            const colIdx = dayIdx - 1;
            const rowIdx = period - 1;
            const cell = rows[rowIdx][colIdx];
            
            const td = document.createElement("td");
            if (cell && cell.subject) {
              td.className = cell.class || "";
              td.textContent = cell.subject;
              if (cell.teacher) {
                td.setAttribute("data-tooltip", cell.teacher);
                if (cell.teacher.includes("V√µ Thanh Phong") || cell.teacher.includes("Phong")) {
                  td.setAttribute("data-tooltip-gvcn", "");
                }
              }
            } else {
              td.textContent = "-";
            }
            tr.appendChild(td);
          }
          tbody.appendChild(tr);
        }
      }

      async function loadTimetable() {
        const statusEl = document.getElementById("timetable-status");
        if (!TIMETABLE_URL) {
          if (statusEl) statusEl.textContent = "Ch∆∞a c·∫•u h√¨nh URL th·ªùi kh√≥a bi·ªÉu.";
          return;
        }

        try {
          if (statusEl) {
            statusEl.textContent = "ƒêang t·∫£i th·ªùi kh√≥a bi·ªÉu t·ª´ Google Sheets...";
            statusEl.style.color = "#555";
            statusEl.style.display = "block";
          }
          
          // X√ìA S·∫†CH D·ªÆ LI·ªÜU C≈® TR∆Ø·ªöC
          const morningBody = document.getElementById("timetable-morning-body");
          const afternoonBody = document.getElementById("timetable-afternoon-body");
          if (morningBody) morningBody.innerHTML = "";
          if (afternoonBody) afternoonBody.innerHTML = "";
          
          const resp = await fetch(TIMETABLE_URL, { cache: "no-store" });
          if (!resp.ok) throw new Error("HTTP " + resp.status);
          const text = await resp.text();
          console.log("CSV raw text (first 2000 chars):", text.substring(0, 2000));
          
          const rows = parseCsv(text);
          console.log("Parsed rows count:", rows.length);
          console.log("First 10 rows:", rows.slice(0, 10));
          
          if (!rows.length) throw new Error("Kh√¥ng c√≥ d·ªØ li·ªáu");

          // T√¨m header row v·ªõi c√°c c·ªôt: TI·∫æT, T2, T3, T4, T5, T6, T7, CN
          let headerRowIdx = -1;
          let colMap = {};
          
          for (let i = 0; i < Math.min(10, rows.length); i++) {
            const row = rows[i] || [];
            const rowLower = row.map(c => (c || "").toLowerCase().trim());
            
            // T√¨m c·ªôt TI·∫æT v√† c√°c c·ªôt T2-T7, CN
            let foundTiet = false;
            let foundDays = 0;
            const tempColMap = {};
            
            rowLower.forEach((cell, idx) => {
              if (cell === "ti·∫øt" || cell === "tiet" || cell === "period") {
                tempColMap.tiet = idx;
                foundTiet = true;
              }
              if (cell === "t2" || cell === "hai" || cell === "th·ª© hai") {
                tempColMap.t2 = idx;
                foundDays++;
              }
              if (cell === "t3" || cell === "ba" || cell === "th·ª© ba") {
                tempColMap.t3 = idx;
                foundDays++;
              }
              if (cell === "t4" || cell === "t∆∞" || cell === "th·ª© t∆∞") {
                tempColMap.t4 = idx;
                foundDays++;
              }
              if (cell === "t5" || cell === "nƒÉm" || cell === "th·ª© nƒÉm") {
                tempColMap.t5 = idx;
                foundDays++;
              }
              if (cell === "t6" || cell === "s√°u" || cell === "th·ª© s√°u") {
                tempColMap.t6 = idx;
                foundDays++;
              }
              if (cell === "t7" || cell === "b·∫£y" || cell === "th·ª© b·∫£y") {
                tempColMap.t7 = idx;
                foundDays++;
              }
              if (cell === "cn" || cell === "ch·ªß nh·∫≠t") {
                tempColMap.cn = idx;
                foundDays++;
              }
            });
            
            if (foundTiet && foundDays >= 3) {
              headerRowIdx = i;
              colMap = tempColMap;
              break;
            }
          }
          
          if (headerRowIdx === -1) {
            throw new Error("Kh√¥ng t√¨m th·∫•y header row v·ªõi ƒë·ªãnh d·∫°ng TI·∫æT, T2-T7, CN");
          }
          
          console.log("Header row index:", headerRowIdx);
          console.log("Column mapping:", colMap);
          console.log("Header row:", rows[headerRowIdx]);

          // Map c·ªôt th·ª© sang index trong b·∫£ng HTML (Hai=1, Ba=2, T∆∞=3, NƒÉm=4, S√°u=5, B·∫£y=6)
          const dayColMap = {
            t2: 1, // Hai
            t3: 2, // Ba
            t4: 3, // T∆∞
            t5: 4, // NƒÉm
            t6: 5, // S√°u
            t7: 6  // B·∫£y
            // CN kh√¥ng c√≥ trong b·∫£ng HTML (ch·ªâ c√≥ 6 c·ªôt)
          };

          // Parse d·ªØ li·ªáu t·ª´ d√≤ng sau header
          const morningData = Array(5).fill(null).map(() => Array(6).fill(null));
          const afternoonData = Array(5).fill(null).map(() => Array(6).fill(null));
          
          let currentSession = "morning"; // m·∫∑c ƒë·ªãnh l√† s√°ng
          let countAdded = 0;
          
          for (let i = headerRowIdx + 1; i < rows.length; i++) {
            const row = rows[i] || [];
            const firstCell = String(row[0] || "").trim().toLowerCase();
            
            // Ki·ªÉm tra n·∫øu l√† marker bu·ªïi (7H, 2H, S√ÅNG, CHI·ªÄU)
            if (firstCell.includes("7h") || firstCell.includes("s√°ng") || firstCell === "morning") {
              currentSession = "morning";
              continue;
            }
            if (firstCell.includes("2h") || firstCell.includes("chi·ªÅu") || firstCell === "afternoon") {
              currentSession = "afternoon";
              continue;
            }
            if (firstCell.includes("ngh·ªâ") || firstCell.includes("break") || firstCell === "") {
              continue; // B·ªè qua d√≤ng ngh·ªâ ho·∫∑c d√≤ng tr·ªëng
            }
            
            // L·∫•y s·ªë ti·∫øt t·ª´ c·ªôt TI·∫æT ho·∫∑c c·ªôt ƒë·∫ßu ti√™n
            let periodStr = "";
            if (colMap.tiet !== undefined && row[colMap.tiet]) {
              periodStr = String(row[colMap.tiet]).trim();
            } else if (row[0]) {
              periodStr = String(row[0]).trim();
            }
            
            // Th·ª≠ parse s·ªë ti·∫øt - c√≥ th·ªÉ l√† "1", "2", v.v. ho·∫∑c ch·ªâ c√≥ s·ªë
            let period = parseInt(periodStr);
            
            // N·∫øu kh√¥ng parse ƒë∆∞·ª£c t·ª´ c·ªôt ƒë·∫ßu, th·ª≠ t√¨m s·ªë trong to√†n b·ªô d√≤ng
            if (!period || period < 1 || period > 5) {
              // T√¨m s·ªë ti·∫øt trong c√°c cell ƒë·∫ßu ti√™n
              for (let j = 0; j < Math.min(3, row.length); j++) {
                const testStr = String(row[j] || "").trim();
                const testNum = parseInt(testStr);
                if (testNum >= 1 && testNum <= 5) {
                  period = testNum;
                  break;
                }
              }
            }
            
            // N·∫øu v·∫´n kh√¥ng t√¨m th·∫•y s·ªë ti·∫øt h·ª£p l·ªá, b·ªè qua d√≤ng n√†y
            if (!period || period < 1 || period > 5) {
              console.log(`Skipping row ${i}: no valid period found. First cell: "${firstCell}", periodStr: "${periodStr}"`);
              continue;
            }
            
            const rowIdx = period - 1;
            const targetData = currentSession === "morning" ? morningData : afternoonData;
            
            // ƒê·ªçc gi√° tr·ªã l·ªõp t·ª´ c√°c c·ªôt T2-T7
            for (const [dayKey, dayIdx] of Object.entries(dayColMap)) {
              const colIdx = colMap[dayKey];
              if (colIdx !== undefined && colIdx < row.length) {
                const cellValue = String(row[colIdx] || "").trim();
                if (cellValue && cellValue !== "-" && cellValue !== "" && cellValue.toLowerCase() !== "ngh·ªâ") {
                  targetData[rowIdx][dayIdx - 1] = cellValue; // dayIdx - 1 v√¨ array index t·ª´ 0
                  countAdded++;
                }
              }
            }
          }
          
          console.log(`Parsed ${currentSession} session. Periods found:`, {
            morning: morningData.map((r, i) => r.some(c => c) ? i + 1 : null).filter(x => x),
            afternoon: afternoonData.map((r, i) => r.some(c => c) ? i + 1 : null).filter(x => x)
          });

          console.log("Morning data:", morningData);
          console.log("Afternoon data:", afternoonData);
          console.log("Total cells filled:", countAdded);

          // Render v√†o 2 b·∫£ng
          renderTimetableGrid("timetable-morning", morningData);
          renderTimetableGrid("timetable-afternoon", afternoonData);

          if (statusEl) {
            statusEl.textContent = `ƒê√£ t·∫£i ${countAdded} l·ªõp h·ªçc th√†nh c√¥ng.`;
            statusEl.style.color = "#27ae60";
            setTimeout(() => {
              statusEl.style.display = "none";
            }, 3000);
          }
        } catch (e) {
          console.error("L·ªói t·∫£i th·ªùi kh√≥a bi·ªÉu:", e);
          console.error("Stack:", e.stack);
          if (statusEl) {
            statusEl.textContent = `L·ªói: ${e.message}. Ki·ªÉm tra l·∫°i link CSV ho·∫∑c k·∫øt n·ªëi m·∫°ng. M·ªü Console (F12) ƒë·ªÉ xem chi ti·∫øt.`;
            statusEl.style.color = "#e74c3c";
          }
        }
      }

      // H√†m render m·ªõi cho grid format
      function renderTimetableGrid(tableId, gridData) {
        const table = document.getElementById(tableId);
        if (!table) {
          console.error(`Table ${tableId} not found`);
          return;
        }

        const tbodyId = tableId === "timetable-morning" ? "timetable-morning-body" : "timetable-afternoon-body";
        let tbody = document.getElementById(tbodyId);
        if (!tbody) {
          tbody = table.querySelector("tbody");
        }
        if (!tbody) {
          console.error(`Tbody not found for ${tableId}`);
          return;
        }

        // X√ìA S·∫†CH D·ªÆ LI·ªÜU C≈®
        tbody.innerHTML = "";

        // ƒê·∫£m b·∫£o gridData c√≥ ƒë·ªß 5 h√†ng
        while (gridData.length < 5) {
          gridData.push(Array(6).fill(null));
        }

        // Render t·ª´ grid data: LU√îN render ƒë·ªß 5 h√†ng (ti·∫øt 1-5) x 6 c·ªôt (Hai-B·∫£y)
        for (let period = 1; period <= 5; period++) {
          const tr = document.createElement("tr");
          const periodTd = document.createElement("td");
          periodTd.textContent = period;
          tr.appendChild(periodTd);
          
          const rowIdx = period - 1;
          // ƒê·∫£m b·∫£o h√†ng c√≥ ƒë·ªß 6 c·ªôt
          const rowData = gridData[rowIdx] || Array(6).fill(null);
          
          for (let dayIdx = 1; dayIdx <= 6; dayIdx++) {
            const colIdx = dayIdx - 1;
            const cellValue = rowData[colIdx];
            
            const td = document.createElement("td");
            if (cellValue && String(cellValue).trim() !== "" && String(cellValue).trim() !== "null") {
              td.textContent = cellValue;
              // C√≥ th·ªÉ th√™m class theo l·ªõp h·ªçc n·∫øu c·∫ßn
              const classValue = String(cellValue).toLowerCase().trim();
              if (classValue.includes("12c1") || classValue.includes("11b1")) {
                td.className = "subject-toan"; // V√≠ d·ª•: To√°n cho l·ªõp n√†y
                td.setAttribute("data-tooltip", "V√µ Thanh Phong");
                td.setAttribute("data-tooltip-gvcn", "");
              } else if (classValue.includes("hsg")) {
                td.className = "subject-gdhn"; // V√≠ d·ª•: H·ªçc sinh gi·ªèi
              } else if (classValue.includes("shl")) {
                td.className = "subject-shcn"; // Sinh ho·∫°t l·ªõp
              }
            } else {
              td.textContent = "-";
            }
            tr.appendChild(td);
          }
          tbody.appendChild(tr);
        }
        
        console.log(`Rendered ${tableId}: 5 rows created`);
      }

      document.addEventListener("DOMContentLoaded", () => {
        loadTimetable();
      });

      // ====== ƒê·∫øm ng∆∞·ª£c HK1 -> HK2 -> TN THPT ======
      const EXAM_PHASES = (typeof EXAM_PHASES_CONFIG !== "undefined"
        ? EXAM_PHASES_CONFIG
        : []
      ).map((p) => ({
        label: p.label,
        time: new Date(p.time),
      }));

      function getCurrentPhase() {
        const now = new Date();
        const future = EXAM_PHASES.filter((p) => p.time > now);
        return future.length ? future[0] : null;
      }

      function renderCountdown() {
        const daysEl = document.getElementById("cd-days");
        const hoursEl = document.getElementById("cd-hours");
        const minsEl = document.getElementById("cd-mins");
        const secsEl = document.getElementById("cd-secs");
        const noteEl = document.querySelector(".countdown-note");
        const boxEl = document.getElementById("phase-countdown");
        if (!daysEl || !EXAM_PHASES.length) return;

        const phase = getCurrentPhase();
        if (!phase) {
          if (boxEl) boxEl.style.display = "none";
          return;
        }
        if (boxEl) boxEl.style.display = "";

        if (noteEl) {
          noteEl.textContent = phase.label;
        }

        const now = new Date();
        let diff = phase.time - now;
        if (diff < 0) diff = 0;

        const days = Math.floor(diff / (1000 * 60 * 60 * 24));
        const hours = Math.floor((diff / (1000 * 60 * 60)) % 24);
        const mins = Math.floor((diff / (1000 * 60)) % 60);
        const secs = Math.floor((diff / 1000) % 60);

        daysEl.textContent = String(days).padStart(2, "0");
        hoursEl.textContent = String(hours).padStart(2, "0");
        minsEl.textContent = String(mins).padStart(2, "0");
        secsEl.textContent = String(secs).padStart(2, "0");
      }

        renderCountdown();
        setInterval(renderCountdown, 1000);

        // ƒê·∫øm ng∆∞·ª£c thi H·ªçc sinh gi·ªèi 12/03/2026
        const HSG_EXAM_TIME = typeof HSG_EXAM_TIME_CONFIG !== "undefined"
          ? new Date(HSG_EXAM_TIME_CONFIG)
          : null;

        function renderHsgCountdown() {
            const daysEl = document.getElementById("cd2-days");
            const hoursEl = document.getElementById("cd2-hours");
            const minsEl = document.getElementById("cd2-mins");
            const secsEl = document.getElementById("cd2-secs");
            const boxEl = document.getElementById("hsg-countdown");
            if (!daysEl || !HSG_EXAM_TIME) return;

            const now = new Date();
            let diff = HSG_EXAM_TIME - now;
            if (diff < 0) diff = 0;
            if (diff === 0 && boxEl) {
              boxEl.style.display = "none";
            }

            const days = Math.floor(diff / (1000 * 60 * 60 * 24));
            const hours = Math.floor((diff / (1000 * 60 * 60)) % 24);
            const mins = Math.floor((diff / (1000 * 60)) % 60);
            const secs = Math.floor((diff / 1000) % 60);

            daysEl.textContent = String(days).padStart(2, "0");
            hoursEl.textContent = String(hours).padStart(2, "0");
            minsEl.textContent = String(mins).padStart(2, "0");
            secsEl.textContent = String(secs).padStart(2, "0");
        }

        renderHsgCountdown();
        setInterval(renderHsgCountdown, 1000);

      // ====== N√∫t tu·∫ßn hi·ªán t·∫°i trong nƒÉm h·ªçc ======
      const SCHOOL_WEEKS =
        typeof SCHOOL_WEEKS_CONFIG !== "undefined" ? SCHOOL_WEEKS_CONFIG : [];

      function parseVNDate(str) {
        const [d, m, y] = str.split("/").map(Number);
        if (!d || !m || !y) return null;
        return new Date(y, m - 1, d);
      }

      function findCurrentSchoolWeek() {
        const today = new Date();
        let chosen = null;
        let closest = null;
        let minDiff = Infinity;

        for (const w of SCHOOL_WEEKS) {
          const from = parseVNDate(w.from);
          const to = parseVNDate(w.to);
          if (!from || !to) continue;

          if (today >= from && today <= to) {
            chosen = w;
            break;
          }

          const diff = Math.min(Math.abs(today - from), Math.abs(today - to));
          if (diff < minDiff) {
            minDiff = diff;
            closest = w;
          }
        }

        return chosen || closest || null;
      }

      document.addEventListener("DOMContentLoaded", () => {
        const weekBtn = document.getElementById("week-button");
        const w = findCurrentSchoolWeek();
        if (weekBtn && w) {
          const label = `Tu·∫ßn ${w.week}: ${w.from} ‚Üí ${w.to}`;
          weekBtn.textContent = label;
          if (w.note) {
            weekBtn.title = w.note;
          }
        }
      });
    </script>

    <section class="contact-section">
        <a href="#" data-link="gvcn.phone" class="btn-contact btn-call"><i class="fas fa-phone-volume"></i> G·ªçi ƒêi·ªán</a>
        <a href="#" data-link="gvcn.zalo" class="btn-contact btn-zalo" target="_blank"><i
                class="fas fa-comment-dots"></i> Li√™n h·ªá Zalo</a>
    </section>
</body>

</html>

